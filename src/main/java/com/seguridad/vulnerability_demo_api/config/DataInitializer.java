package com.seguridad.vulnerability_demo_api.config;

import org.springframework.boot.CommandLineRunner;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jdbc.core.JdbcTemplate;

@Configuration
public class DataInitializer {

    @Bean
    CommandLineRunner initDatabase(JdbcTemplate jdbcTemplate) {
        return args -> {
            jdbcTemplate.execute("CREATE TABLE IF NOT EXISTS users (id SERIAL, username VARCHAR(255), password VARCHAR(255), role VARCHAR(255))");
            jdbcTemplate.execute("INSERT INTO users (username, password, role) VALUES ('admin', 'admin1234', 'ADMIN')");
            jdbcTemplate.execute("INSERT INTO users (username, password, role) VALUES ('pepe', 'pasion_por_el_mate', 'USER')");
            jdbcTemplate.execute("INSERT INTO users (username, password, role) VALUES ('leonardo', 'password_seguro_2026', 'USER')");
        };
    }
}